---
ID: 3777
post_title: >
  Python网络爬虫与信息提取（第3周）知识点整理
post_name: 'python%e7%bd%91%e7%bb%9c%e7%88%ac%e8%99%ab%e4%b8%8e%e4%bf%a1%e6%81%af%e6%8f%90%e5%8f%96%ef%bc%88%e7%ac%ac3%e5%91%a8%ef%bc%89%e7%9f%a5%e8%af%86%e7%82%b9%e6%95%b4%e7%90%86'
author: 小奥
post_date: 2018-05-09 20:44:11
layout: post
link: >
  http://www.yushuai.me/2018/05/09/3777.html
published: true
tags:
  - Python
  - 网络爬虫
categories:
  - Python
---
<h1>第三周：网络爬虫之实战</h1><h2>第一节：Re（正则表达式）库入门</h2><p style="text-indent:28px">正则表达式是用来简洁表达一组字符串的表达式。它可以用来表达文本类型的特征。</p><p style="text-indent:28px">正则表达式编译：将符合正则表达式语法的字符串转换成正则表达式特征。</p><p><strong>1.正则表达式的语法</strong></p><p>例如：</p><p>P(Y|YT|YTH|YTHO)?N</p><p style="text-indent:28px">正则表达式语法由字符和操作符构成。正则表达式的常用操作符见表1.1所示。</p><p style="text-align:center">表1.1 正则表达式的常用操作符</p><table><tbody><tr class="firstRow"><td width="56" valign="top" style="border-width: 1px; border-color: windowtext; padding: 0px 7px;"><p style="text-align:center">操作符</p></td><td width="150" valign="top" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; padding: 0px 7px;"><p style="text-align:center">说明</p></td><td width="270" valign="top" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; padding: 0px 7px;"><p style="text-align:center">实例</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>表示任何单个字符</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><br/></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>[]</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>字符集，对单个字符给出取值范围</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>[abc]表示a,b,c，[a-z]表示a到z单个字符</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>[^]</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p><span style="font-size:13px">非字符集，对单个字符给出排除范围</span></p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>[^abc]表示非a或b或c的单个字符</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>*</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>前一个字符0次或无限次扩展</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>abc*表示ab,abc,abcc,abccc等</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>+</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>前一个字符1次或无限次扩展</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>abc+表示abc,abcc,abccc等</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>?</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>前一个字符0次或1次扩展</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>abc?表示ab，abc</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>|</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>左右表达式任意一个</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>abc|def表示abc或def</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>{m}</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>扩展前一个字符m次</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>ab{3}c表示abbbc</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>{m,n}</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>扩展前一个字符m至n（含n）次</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>ab{1,2}c表示abc,abbc</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>^</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>匹配字符串开头</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>^abc表示abc且在第一个字符串的开头</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>$</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>匹配字符串结尾</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>abc$表示abc且在一个字符串的结尾</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>()</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>分组标记，内部只能使用|操作符</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>(abc)表示abc，(abc|def)表示abc、def</p></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>\d</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>数字，等价于[0-9]</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><br/></td></tr><tr><td width="56" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>\w</p></td><td width="150" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>单词字符，等价于[A-Za-z0-9_]</p></td><td width="270" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><br/></td></tr></tbody></table><p style="text-align:center">表1.2 经典正则表达式实例</p><table><tbody><tr class="firstRow"><td width="160" valign="top" style="border-width: 1px; border-color: windowtext; padding: 0px 7px;"><p>^[A-Za-z]+$</p></td><td width="393" valign="top" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; padding: 0px 7px;"><p>由26个字母组成的字符串</p></td></tr><tr><td width="160" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>^[A-Za-z0-9]+$</p></td><td width="393" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>由26个字母和数字组成的字符串</p></td></tr><tr><td width="160" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>^-?\d+$</p></td><td width="393" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>整数形式的字符串</p></td></tr><tr><td width="160" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>^[0-9]*[1-9][0-9]*$</p></td><td width="393" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>正整数形式的字符串</p></td></tr><tr><td width="160" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>[1-9]\d{5}</p></td><td width="393" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>中国境内邮政编码，6位</p></td></tr><tr><td width="160" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>[\u4e00-\u9fa5]</p></td><td width="393" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>匹配中文字符</p></td></tr><tr><td width="160" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>\d{3}-\d{8}|\d{4}-\d{7}</p></td><td width="393" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>国内电话号码（<strong>3位区号-8位</strong>或<strong>4位区号-7位</strong>）</p></td></tr></tbody></table><p style="text-align:center">&nbsp;</p><p><strong>2.Re库的基本使用</strong></p><p>（1）.正则表达式的表示类型</p><p>①raw string类型（原生字符串类型）</p><p>re库采用raw string类型表示正则表达式，表示为：r’text’。例如中国境内邮政编码可以表示为：r’[1-9]\d{5}’。</p><p style="text-indent:28px">raw string（原生字符串）是不包含转移符的字符串。Re库的主要功能函数如表1.3所示。</p><p style="text-align:center">表1.3 Re库主要功能函数</p><table><tbody><tr class="firstRow"><td width="75" valign="top" style="border-width: 1px; border-color: windowtext; padding: 0px 7px;"><p style="text-align:center">函数</p></td><td width="478" valign="top" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; padding: 0px 7px;"><p style="text-align:center">说明</p></td></tr><tr><td width="75" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>re.search()</p></td><td width="478" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>在一个字符串中搜索匹配正则表达式的第一个位置，返回match对象。</p></td></tr><tr><td width="75" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>re.match()</p></td><td width="478" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>从第一个字符串的<strong><span style="color:red">开始位置</span></strong>其匹配正则表达式，返回match对象。</p></td></tr><tr><td width="75" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>re.findall()</p></td><td width="478" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>搜索字符串，以列表类型返回全部能匹配的子串。</p></td></tr><tr><td width="75" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>re.split()</p></td><td width="478" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>将一个字符串按照正则表达式匹配结果进行分隔，返回列表类型，<strong>匹配的部分去掉</strong>。</p></td></tr><tr><td width="75" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>re.finditer()</p></td><td width="478" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>搜索字符串，返回一个匹配结果的迭代类型，每个元素都是match对象。</p></td></tr><tr><td width="75" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>re.sub()</p></td><td width="478" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>在一个字符串中替换所有匹配正则表达式的子串，返回替换后的字符串。</p></td></tr></tbody></table><p style="text-indent:28px">（2）功能函数的基本介绍</p><p style="text-indent:28px">①re.search(pattern, string, flags=0)</p><p style="text-indent:28px">在一个字符串中搜索匹配正则表达式的第一个位置，返回match对象。后面参数中，pattern是正则表达式的字符串或原生字符串表示；string是待匹配字符串，flags是使用时的控制标记。标记包括re.I（re.IGNORECASE）忽略正则表达式的大小写，[A-Z]能够匹配小鞋字符；re.M(re.MULTILINE)正则表达式中的^操作符能够将给定字符串的每行当作匹配开始；re.S(re.DOTALL)正则表达式中的.操作符能够匹配所有字符，默认匹配除换行外的所有字符。</p><p style="text-indent:28px">②re.findall(pattern, string, flags=0)</p><p style="text-indent:28px">例程：</p><pre class="brush:python;toolbar:false">import&nbsp;re
ls&nbsp;=re.findall(r&#39;[1-9]\d{5}&#39;,&#39;BIT&nbsp;100081&nbsp;TSU100084&nbsp;XDU710071&#39;)
print(ls)</pre><p style="text-indent:28px">结果：</p><p>[&#39;100081&#39;, &#39;100084&#39;, &#39;710071&#39;]</p><p style="text-indent:28px">③re.split(pattern, string, maxsplit=0, flags=0)</p><p style="text-indent:28px">maxsplit表示最大分个数，剩余部分作为最后一个元素输出。</p><p style="text-indent:28px">代码：</p><pre class="brush:python;toolbar:false">import&nbsp;re
ls&nbsp;=re.split(r&#39;[1-9]\d{5}&#39;,&#39;BIT&nbsp;100081&nbsp;TSU100084&nbsp;XDU710071&#39;,maxsplit&nbsp;=1)
#只匹配第一个
print(ls)</pre><p style="text-indent:28px">结果：</p><p>[&#39;BIT &#39;, &#39; TSU100084 XDU710071&#39;]</p><p style="text-indent:28px">④re.finditer(pattern, string, flags=0)</p><p style="text-indent:28px">代码：</p><pre class="brush:python;toolbar:false">import&nbsp;re
for&nbsp;m&nbsp;in&nbsp;re.finditer(r&#39;[1-9]\d{5}&#39;,&#39;BIT&nbsp;100081&nbsp;TSU100084&nbsp;XDU710071&#39;):
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(m.group(0))</pre><p style="text-indent:28px">结果：</p><p>100081</p><p>100084</p><p>710071</p><p style="text-indent:28px">⑤re.sub(pattern,rep,string, count=0,flags=0)</p><p style="text-indent:28px">rep是替换匹配字符串的字符串，count代表匹配的最大次数。</p><p style="text-indent:28px">例程：</p><pre class="brush:python;toolbar:false">import&nbsp;re
print(re.sub(r&#39;[1-9]\d{5}&#39;,&nbsp;&#39;xiaoao&#39;,&#39;BIT&nbsp;100081&nbsp;TSU100084&nbsp;XDU710071&#39;,count=1))</pre><p style="text-indent:28px">结果：</p><p>BIT xiaoao TSU100084 XDU710071</p><p style="text-indent:28px">（3）Re库的另一种等价用法</p><p style="text-indent:28px">例如，原来我们使用这种函数式用法，这是一种一次性操作。</p><pre class="brush:python;toolbar:false">rst&nbsp;=&nbsp;re.search(r&#39;[1-9]\d{5}&#39;,&#39;BIT&nbsp;100081&nbsp;TSU100084&nbsp;XDU710071&#39;)</pre><p style="text-indent:28px">现在我们可以采用面向对象用法，可以在编译后多次操作。</p><pre class="brush:python;toolbar:false">pat&nbsp;=&nbsp;re.compile(r’&nbsp;[1-9]\d{5}’)
rst&nbsp;=&nbsp;pat.search(‘BIT&nbsp;100081&nbsp;TSU100084&nbsp;XDU710071’)
regex&nbsp;=&nbsp;re.compile(pattern,&nbsp;flags=0)</pre><p style="text-indent:28px">将正则表达式的字符串形式编译成正则表达式对象。</p><p><strong>3.Re库的match对象</strong></p><p style="text-indent:28px">match对象的属性如表1.4所示。</p><p style="text-align:center">表1.4 Match对象的属性</p><table><tbody><tr class="firstRow"><td width="85" valign="top" style="border-width: 1px; border-color: windowtext; padding: 0px 7px;"><p style="text-align:center">属性</p></td><td width="468" valign="top" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; padding: 0px 7px;"><p style="text-align:center">说明</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.string</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>待匹配的文本</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.re</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>匹配使用的pattern对象（正则表达式）</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.pos</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>正则表达式搜索文本的开始位置</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.endpos</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>正则表达式搜索文本的结束位置</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.group(0)</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>返回匹配后的字符串</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.start()</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>匹配字符串在原始字符串的开始位置</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.end()</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>匹配字符串在原始字符串的结束位置</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p>.span()</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>返回(.start(),.end())，是<strong>元组类型</strong>。</p></td></tr></tbody></table><p style="text-align:center">&nbsp;</p><p><strong>4.Re库的贪婪匹配和最小匹配</strong></p><p style="text-indent:28px">（1）贪婪匹配</p><p style="text-indent:28px">Re库默认采用贪婪匹配，即输出匹配最长的子串。例如输入：</p><pre class="brush:python;toolbar:false">import&nbsp;re
match&nbsp;=&nbsp;re.search(r&#39;PY.*N&#39;,&nbsp;&#39;PYANBNCNDN&#39;)
print(match.group(0))</pre><p style="text-indent:28px">结果为：</p><p>PYANBNCNDN</p><p style="text-indent:28px">（2）最小匹配</p><p style="text-indent:28px">代码如下：</p><pre class="brush:python;toolbar:false">import&nbsp;re
match&nbsp;=&nbsp;re.search(r&#39;PY.*?N&#39;,&nbsp;&#39;PYANBNCNDN&#39;)
print(match.group(0))</pre><p style="text-indent:28px">结果：</p><p>PYAN</p><p style="text-indent:28px">最小匹配操作符如表1.5所示。</p><p style="text-align:center">表1.5 最小匹配操作符</p><table><tbody><tr class="firstRow"><td width="85" valign="top" style="border-width: 1px; border-color: windowtext; padding: 0px 7px;"><p style="text-align:center">操作符</p></td><td width="468" valign="top" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; padding: 0px 7px;"><p style="text-align:center">说明</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p style="text-align:center">*?</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>前一个字符0次或无限次扩展，最小匹配。</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p style="text-align:center">+?</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>前一个字符1次或无限次扩展，最小匹配。</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p style="text-align:center">??</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>前一个字符0次或1次扩展，最小匹配。</p></td></tr><tr><td width="85" valign="top" style="border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0px 7px;"><p style="text-align:center">{m,n,}?</p></td><td width="468" valign="top" style="border-top: none; border-left: none; border-bottom-width: 1px; border-bottom-color: windowtext; border-right-width: 1px; border-right-color: windowtext; padding: 0px 7px;"><p>扩展前一个字符m至n次（含n），最小匹配。</p></td></tr></tbody></table><p style="text-align:center">&nbsp;</p><h2>第二节：实例2：淘宝商品比价定向爬虫</h2><p><strong>1.实例介绍</strong></p><p>功能描述：</p><p style="text-indent:28px">目标：获取淘宝搜索页面的信息，提取其中的商品名称和价格。</p><p style="text-indent:28px">理解：淘宝的搜索接口；翻页的处理。</p><p style="text-indent:28px">技术路线：requests库+re库。</p><p>程序结构设计</p><p style="text-indent:28px">步骤1：提交商品搜索请求，循环获取页面。</p><p style="text-indent:28px">步骤2：对于每个页面，提取商品名称和价格信息。</p><p style="text-indent:28px">步骤3：将信息输出到屏幕上。</p><p><strong>2.实例编写</strong></p><p style="text-indent:28px">代码：</p><pre class="brush:python;toolbar:false">import&nbsp;requests
import&nbsp;re
&nbsp;
def&nbsp;getHTMLText(url):
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;requests.get(url,&nbsp;timeout=30)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.raise_for_status()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.encoding&nbsp;=&nbsp;r.apparent_encoding
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r.text
&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;&quot;
def&nbsp;parsePage(ilt,&nbsp;html):
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt&nbsp;=&nbsp;re.findall(r&#39;\&quot;view_price\&quot;\:\&quot;[\d\.]*\&quot;&#39;,html)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tlt&nbsp;=&nbsp;re.findall(r&#39;\&quot;raw_title\&quot;\:\&quot;.*?\&quot;&#39;,html)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(plt)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price&nbsp;=&nbsp;eval(plt[i].split(&#39;:&#39;)[1])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;=&nbsp;eval(tlt[i].split(&#39;:&#39;)[1])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ilt.append([price&nbsp;,&nbsp;title])
&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;&quot;)
def&nbsp;printGoodsList(ilt):
&nbsp;&nbsp;&nbsp;&nbsp;tplt&nbsp;=&nbsp;&quot;{:4}\t{:8}\t{:16}&quot;
&nbsp;&nbsp;&nbsp;&nbsp;print(tplt.format(&quot;序号&quot;,&nbsp;&quot;价格&quot;,&nbsp;&quot;商品名称&quot;))
&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;in&nbsp;ilt:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(tplt.format(count,&nbsp;g[0],&nbsp;g[1]))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;main():
&nbsp;&nbsp;&nbsp;&nbsp;goods=&#39;书包&#39;
&nbsp;&nbsp;&nbsp;&nbsp;depth&nbsp;=&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;start_url&nbsp;=&nbsp;&#39;https://s.taobao.com/search?q=&#39;&nbsp;+&nbsp;goods
&nbsp;&nbsp;&nbsp;&nbsp;infoList&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(depth):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;start_url&nbsp;+&nbsp;&#39;&amp;s=&#39;&nbsp;+&nbsp;str(44*i)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;getHTMLText(url)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parsePage(infoList,&nbsp;html)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;&nbsp;&nbsp;&nbsp;printGoodsList(infoList)
&nbsp;
main()</pre><p>结果（2018年5月7日22:08结果）：</p><p>序号&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 价格&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 商品名称&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 79.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 小学生大空间容量女生公主书包双肩背包减负</p><p>&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 69.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 艾奔 双肩包男背包女韩版潮 商务男士电脑包高中学生书包休闲旅行</p><p>&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; 39.90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 迪卡侬双肩包男女学生书包健身包运动新款校园20升休闲 KIPSTA</p><p>&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp; 59.80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 商务背包男士双肩包韩版潮流旅行包休闲女学生书包简约时尚电脑包</p><p>&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp; 49.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 书包小学生 1-2-3-6年级男女生减负双肩儿童书包男孩防水护脊背包</p><p>&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 69.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包男士背包时尚潮流初中高中学生书包大学生女商务旅行电脑包</p><p>&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp; 59.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 男背包旅游休闲商务电脑韩版时尚潮流大高中学生书包旅行双肩包</p><p>&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp; 59.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 背包男韩版时尚潮流双肩包休闲商务电脑旅行大容量高中大学生书包</p><p>&nbsp;&nbsp; 9&nbsp;&nbsp;&nbsp; 129.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 七匹狼商务双肩包男书包中学生女电脑包旅行包休闲男士背包大容量</p><p>&nbsp; 10&nbsp;&nbsp;&nbsp; 99.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 米熙休闲运动背包双肩包女书包中学生男时尚潮流大容量旅游旅行包</p><p>&nbsp; 11&nbsp;&nbsp;&nbsp; 138.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包女背包2018新款韩版潮牛津布帆布百搭防盗女士旅行休闲包包</p><p>&nbsp; 12&nbsp;&nbsp;&nbsp; 69.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2018新款双肩包女牛津布韩版潮百搭背包时尚休闲书包女包包旅行包</p><p>&nbsp; 13&nbsp;&nbsp;&nbsp; 119.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 巴朗新款商务双肩包休闲时尚潮流大学生书包15.6寸电脑包男士背包</p><p>&nbsp; 14&nbsp;&nbsp;&nbsp; 55.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包女包包2018新款韩版潮时尚个性百搭2017牛津帆布小书包背包</p><p>&nbsp; 15&nbsp;&nbsp;&nbsp; 129.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 七匹狼双肩包男 韩版女休闲潮包 学生书包电脑包旅行包双肩背包男</p><p>&nbsp; 16&nbsp;&nbsp;&nbsp; 69.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包女2018新款包包韩版百搭时尚背包女双肩软皮旅行包书包女包</p><p>&nbsp; 17&nbsp;&nbsp;&nbsp; 49.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 背包男双肩包高中初中学生韩版书包男时尚潮流青年电脑旅游旅行包</p><p>&nbsp; 18&nbsp;&nbsp;&nbsp; 149.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 小米双肩包简约休闲多功能书包男女笔记本电脑包时尚潮流旅行背包</p><p>&nbsp; 19&nbsp;&nbsp;&nbsp; 69.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包女包包2018新款韩版潮个性百搭时尚迷你小2017书包女士背包</p><p>&nbsp; 20&nbsp;&nbsp;&nbsp; 139.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 施维茨男士双肩包大容量背包女商务电脑旅行包休闲潮高中学生书包</p><p>&nbsp; 21&nbsp;&nbsp;&nbsp; 139.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 瑞士军刀双肩包男瑞士电脑旅行背包女大容量高中大学初中学生书包</p><p>&nbsp; 22&nbsp;&nbsp;&nbsp; 139.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 七匹狼背包男商务双肩包男士旅行休闲时尚潮流电脑青年书包大容量</p><p>&nbsp; 23&nbsp;&nbsp;&nbsp; 139.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 赫登尔双肩包男士潮流背包男韩版旅行包时尚休闲学生书包电脑包潮</p><p>&nbsp; 24&nbsp;&nbsp;&nbsp; 125.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 瑞士军刀双肩包瑞士中学生书包女休闲男士商务旅行大容量电脑背包</p><p>&nbsp; 25&nbsp;&nbsp;&nbsp; 208.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 【香港直邮】anello双肩包男女离家出走包学生书包旅行包休闲背包</p><p>&nbsp; 26&nbsp;&nbsp;&nbsp; 79.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 书包小学生男1-3-4-6年级儿童减负护脊女6-12周岁初中学生双肩包</p><p>&nbsp; 27&nbsp;&nbsp;&nbsp; 119.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 韩国kk树书包小学生男1-3-4-6年级儿童书包女6-12周岁双肩包护脊</p><p>&nbsp; 28&nbsp;&nbsp;&nbsp; 79.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;书包女韩版原宿ulzzang 高中学生2018新款初中生校园甜甜圈双肩包</p><p>&nbsp; 29&nbsp;&nbsp;&nbsp; 118.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 瑞士军刀双肩包男士背包大容量休闲商务电脑包韩版高中书包旅行包</p><p>&nbsp; 30&nbsp;&nbsp;&nbsp; 149.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包男士时尚潮流背包韩版个性书包男大学生运动休闲电脑旅行包</p><p>&nbsp; 31&nbsp;&nbsp;&nbsp; 89.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 双肩包男帆布背包电脑包休闲防水运动后背包男旅行包青年学生书包</p><p>&nbsp; 32&nbsp;&nbsp;&nbsp; 208.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 日本anello双肩包女防水牛津布乐天背包学生书包离家出走包alleno</p><p>&nbsp; 33&nbsp;&nbsp;&nbsp; 158.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 专柜正品JanSport杰斯伯经典双肩背包男女同款学生书包T501纯色</p><p>&nbsp; 34&nbsp;&nbsp;&nbsp; 69.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 休闲双肩包韩版简约旅行背包电脑初中高中学生校园书包男时尚潮流</p><p>&nbsp; 35&nbsp;&nbsp;&nbsp; 129.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 男士双肩包男韩版时尚背包男大学生书包潮流旅行包电脑包男包皮包</p><p>&nbsp; 36&nbsp;&nbsp;&nbsp; 189.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 商务双肩包男大容量青年短途出差旅行包17寸电脑包多功能防盗背包</p><h2>第三节：实例3：股票数据定向爬虫</h2><p><strong>1.实例介绍</strong></p><p>功能描述：</p><p style="text-indent:28px">目标：获取上交所和深交所所有股票的名称和交易信息。</p><p style="text-indent:28px">输出：保存在文件中。</p><p style="text-indent:28px">技术路线：requests库++bs4库+re库。</p><p>候选数据网站选择：</p><p style="text-indent:28px">选取原则：信息静态存在于HTML页面中，非js代码生成，没有Robots协议限制。</p><p style="text-indent:28px">选取方法：查看源代码等。</p><p style="text-indent:28px">选取心态：不要纠结于某个网站，多找信息源尝试。</p><p>程序结构设计</p><p style="text-indent:28px">步骤1：从东方财富网获取股票列表。</p><p style="text-indent:28px">步骤2：根据股票列表逐个到百度股票获取个股信息。。</p><p style="text-indent:28px">步骤3：将结果存储到文件中。</p><p><strong>2.实例编写</strong></p><p>代码：</p><pre class="brush:python;toolbar:false">import&nbsp;requests
from&nbsp;bs4&nbsp;import&nbsp;BeautifulSoup
import&nbsp;traceback
import&nbsp;re
&nbsp;
def&nbsp;getHTMLText(url):
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;requests.get(url)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.raise_for_status()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.encoding&nbsp;=&nbsp;r.apparent_encoding
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r.text
&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;&quot;
&nbsp;
def&nbsp;getStockList(lst,&nbsp;stockURL):
&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;getHTMLText(stockURL)
&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html,&nbsp;&#39;html.parser&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;soup.find_all(&#39;a&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;a:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href&nbsp;=&nbsp;i.attrs[&#39;href&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst.append(re.findall(r&quot;[s][hz]\d{6}&quot;,&nbsp;href)[0])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;
def&nbsp;getStockInfo(lst,&nbsp;stockURL,&nbsp;fpath):
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;stock&nbsp;in&nbsp;lst:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;stockURL&nbsp;+&nbsp;stock&nbsp;+&nbsp;&quot;.html&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;getHTMLText(url)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html==&quot;&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoDict&nbsp;=&nbsp;{}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html,&nbsp;&#39;html.parser&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stockInfo&nbsp;=&nbsp;soup.find(&#39;div&#39;,attrs={&#39;class&#39;:&#39;stock-bets&#39;})
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;stockInfo.find_all(attrs={&#39;class&#39;:&#39;bets-name&#39;})[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoDict.update({&#39;股票名称&#39;:&nbsp;name.text.split()[0]})
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyList&nbsp;=&nbsp;stockInfo.find_all(&#39;dt&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valueList&nbsp;=&nbsp;stockInfo.find_all(&#39;dd&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(keyList)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;=&nbsp;keyList[i].text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;valueList[i].text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoDict[key]&nbsp;=&nbsp;val
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(fpath,&nbsp;&#39;a&#39;,&nbsp;encoding=&#39;utf-8&#39;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(&nbsp;str(infoDict)&nbsp;+&nbsp;&#39;\n&#39;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traceback.print_exc()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;
def&nbsp;main():
&nbsp;&nbsp;&nbsp;&nbsp;stock_list_url&nbsp;=&nbsp;&#39;http://quote.eastmoney.com/stocklist.html&#39;
&nbsp;&nbsp;&nbsp;&nbsp;stock_info_url&nbsp;=&nbsp;&#39;http://gupiao.baidu.com/stock/&#39;
&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;&#39;D:/BaiduStockInfo.txt&#39;
&nbsp;&nbsp;&nbsp;&nbsp;slist=[]
&nbsp;&nbsp;&nbsp;&nbsp;getStockList(slist,&nbsp;stock_list_url)
&nbsp;&nbsp;&nbsp;&nbsp;getStockInfo(slist,&nbsp;stock_info_url,&nbsp;output_file)
&nbsp;
main()</pre><p><strong>3.编写优化</strong></p><p>代码：</p><pre class="brush:python;toolbar:false">import&nbsp;requests
from&nbsp;bs4&nbsp;import&nbsp;BeautifulSoup
import&nbsp;traceback
import&nbsp;re
&nbsp;
def&nbsp;getHTMLText(url,&nbsp;code=&quot;utf-8&quot;):
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;requests.get(url)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.raise_for_status()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.encoding&nbsp;=&nbsp;code
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r.text
&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;&quot;
&nbsp;
def&nbsp;getStockList(lst,&nbsp;stockURL):
&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;getHTMLText(stockURL,&nbsp;&quot;GB2312&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html,&nbsp;&#39;html.parser&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;soup.find_all(&#39;a&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;a:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href&nbsp;=&nbsp;i.attrs[&#39;href&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lst.append(re.findall(r&quot;[s][hz]\d{6}&quot;,&nbsp;href)[0])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;
def&nbsp;getStockInfo(lst,&nbsp;stockURL,&nbsp;fpath):
&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;stock&nbsp;in&nbsp;lst:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;stockURL&nbsp;+&nbsp;stock&nbsp;+&nbsp;&quot;.html&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;getHTMLText(url)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html==&quot;&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoDict&nbsp;=&nbsp;{}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html,&nbsp;&#39;html.parser&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stockInfo&nbsp;=&nbsp;soup.find(&#39;div&#39;,attrs={&#39;class&#39;:&#39;stock-bets&#39;})
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;stockInfo.find_all(attrs={&#39;class&#39;:&#39;bets-name&#39;})[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoDict.update({&#39;股票名称&#39;:&nbsp;name.text.split()[0]})
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyList&nbsp;=&nbsp;stockInfo.find_all(&#39;dt&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valueList&nbsp;=&nbsp;stockInfo.find_all(&#39;dd&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(keyList)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;=&nbsp;keyList[i].text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;valueList[i].text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoDict[key]&nbsp;=&nbsp;val
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(fpath,&nbsp;&#39;a&#39;,&nbsp;encoding=&#39;utf-8&#39;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(&nbsp;str(infoDict)&nbsp;+&nbsp;&#39;\n&#39;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;\r当前进度:&nbsp;{:.2f}%&quot;.format(count*100/len(lst)),end=&quot;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;\r当前进度:&nbsp;{:.2f}%&quot;.format(count*100/len(lst)),end=&quot;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;
def&nbsp;main():
&nbsp;&nbsp;&nbsp;&nbsp;stock_list_url&nbsp;=&nbsp;&#39;http://quote.eastmoney.com/stocklist.html&#39;
&nbsp;&nbsp;&nbsp;&nbsp;stock_info_url&nbsp;=&nbsp;&#39;http://gupiao.baidu.com/stock/&#39;
&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;=&nbsp;&#39;BaiduStockInfo.txt&#39;
&nbsp;&nbsp;&nbsp;&nbsp;slist=[]
&nbsp;&nbsp;&nbsp;&nbsp;getStockList(slist,&nbsp;stock_list_url)
&nbsp;&nbsp;&nbsp;&nbsp;getStockInfo(slist,&nbsp;stock_info_url,&nbsp;output_file)
main()</pre><p><br/></p>