---
ID: 3557
post_title: >
  吴恩达深度学习课程
  DeepLearning.ai 编程作业（1-3）
post_name: '%e5%90%b4%e6%81%a9%e8%be%be%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0%e8%af%be%e7%a8%8b-deeplearning-ai-%e7%bc%96%e7%a8%8b%e4%bd%9c%e4%b8%9a%ef%bc%88%e7%ac%ac%e4%b8%89%e5%91%a8%ef%bc%89%ef%bc%881%ef%bc%89'
author: 小奥
post_date: 2018-02-01 20:00:23
layout: post
link: >
  http://www.yushuai.me/2018/02/01/3557.html
published: true
tags:
  - Python
  - 人工智能
  - 深度学习
categories:
  - Deep Learning
---
<p style="margin: 8px 0 16px;line-height: 36px;background: white"><strong><span style="font-size:28px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">Planar data classification with one hidden layer</span></strong></p><p style="line-height: 32px;background: white"><a></a><strong><span style="font-size:24px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">1 - Packages</span></strong></p><p style="line-height:26px;background:white"><span style="font-size:16px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">Let</span><span style="font-size:16px;font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">’s first import all the packages that you will need during this assignment.&nbsp;<br/> -&nbsp;<a href="http://www.numpy.org" target="_blank"><span style="color:#6795B5">numpy</span></a>&nbsp;is the fundamental package for scientific computing with Python.&nbsp;<br/> -&nbsp;<a href="http://scikit-learn.org/stable/" target="_blank"><span style="color:#6795B5">sklearn</span></a>&nbsp;provides simple and efficient tools for data mining and data analysis.&nbsp;<br/> -&nbsp;<a href="http://matplotlib.org/" target="_blank"><span style="color: #6795B5">matplotlib</span></a>&nbsp;is a library for plotting graphs in Python.&nbsp;<br/> - testCases_v2 provides some test examples to assess the correctness of your functions&nbsp;<br/> - planar_utils provide various useful functions used in this assignment</span></p><h2 style="margin-top:8px;margin-right:0;margin-bottom:16px;margin-left: 0;line-height:32px;background:white"><span style="font-family: &#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">2 - Dataset</span></h2><p style="margin: 0 0 16px;text-align: justify;line-height: 26px;background: white;box-sizing: border-box"><span style="font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">First, let</span><span style="font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">’s get the dataset you will work on. The following code will load a “flower” 2-class dataset into variables&nbsp;</span><code style="box-sizing: border-box;border-radius: 4px"><span style="font-size:14px;font-family:Consolas;color:#C7254E;background:#F9F2F4">X</span></code><span style="font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">&nbsp;</span><span style="font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">and&nbsp;</span><code style="box-sizing: border-box;border-radius: 4px"><span style="font-size:14px;font-family:Consolas;color:#C7254E;background:#F9F2F4">Y</span></code><span style="font-family:&#39;微软雅黑&#39;,sans-serif;color:#4F4F4F">.</span></p><p><span style=";font-family:Consolas;color:#000088">X, Y = load_planar_dataset()</span></p><p><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F;background: white">Visualize the dataset using matplotlib. The data looks like a “flower” with some red (label y=0) and some blue (y=1) points. Your goal is to build a model to fit this data.</span></p><pre class="brush:python;toolbar:false">plt.scatter(X[0,&nbsp;:],&nbsp;X[1,&nbsp;:],&nbsp;c=np.squeeze(Y),&nbsp;s=40,&nbsp;cmap=plt.cm.Spectral);#将Y中的单维去掉</pre><p>Exercise: How many training examples do you have? In addition, what is the shape of the variables X and Y?</p><pre class="brush:python;toolbar:false">shape_X&nbsp;=&nbsp;X.shape
print(&quot;X&#39;s&nbsp;shape&nbsp;is&nbsp;&quot;&nbsp;+&nbsp;str(shape_X))
shape_Y&nbsp;=&nbsp;Y.shape
print(&quot;Y&#39;s&nbsp;shape&nbsp;is&nbsp;&quot;&nbsp;+&nbsp;str(shape_Y))
m=X.shape[1]
print(&quot;We&nbsp;have&nbsp;&quot;&nbsp;+&nbsp;str(m)&nbsp;+&nbsp;&quot;&nbsp;examples.&quot;)</pre><p>&nbsp;</p><h2 style="margin-top:13px;margin-right:0;margin-bottom:13px;margin-left: 0;background:white"><span style="font-size:35px;font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">3 - Simple Logistic Regression</span></h2><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Before building a full neural network, lets first see how logistic regression performs on this problem. You can use sklearn’s built-in functions to do that. Run the code below to train a logistic regression classifier on the dataset.&nbsp;</span></p><pre class="brush:python;toolbar:false">#&nbsp;Train&nbsp;the&nbsp;logistic&nbsp;regression&nbsp;classifier
clf&nbsp;=&nbsp;sklearn.linear_model.LogisticRegressionCV();
clf.fit(X.T,&nbsp;Y.T);
#&nbsp;Plot&nbsp;the&nbsp;decision&nbsp;boundary&nbsp;for&nbsp;logistic&nbsp;regression
plot_decision_boundary(lambda&nbsp;x:&nbsp;clf.predict(x),&nbsp;X,&nbsp;np.squeeze(Y))
plt.title(&quot;Logistic&nbsp;Regression&quot;)
&nbsp;
#&nbsp;Print&nbsp;accuracy
LR_predictions&nbsp;=&nbsp;clf.predict(X.T)
print&nbsp;(&#39;Accuracy&nbsp;of&nbsp;logistic&nbsp;regression:&nbsp;%d&nbsp;&#39;&nbsp;%&nbsp;float((np.dot(Y,LR_predictions)&nbsp;+&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.dot(1-Y,1-LR_predictions))/float(Y.size)*100)&nbsp;+&nbsp;&#39;%&nbsp;&#39;&nbsp;+&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;(percentage&nbsp;of&nbsp;correctly&nbsp;labelled&nbsp;datapoints)&quot;)</pre><p style="text-align: center;"><img src="/wp-content/uploads/image/20180201/1517492129620953.png" title="1517492129620953.png" alt="1.png"/></p><h2 style="margin-top:13px;margin-right:0;margin-bottom:13px;margin-left: 0;background:white"><span style="font-size:35px;font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">4 - Neural Network model</span></h2><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Logistic regression did not work well on the “flower dataset”. You are going to train a Neural Network with a single hidden layer.</span></p><p style="margin-top:0;margin-right:0;margin-bottom:27px;margin-left: 0;line-height:27px;background:white"><strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Reminder</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">: The general methodology to build a Neural Network is to:&nbsp;<br/> 1. Define the neural network structure ( # of input units, # of hidden units, etc). (</span><span style=";color:#3F3F3F">定义神经网络结构（输入单元数量，隐藏单元数量等）。</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> 2. Initialize the model’s parameters(</span><span style=";color:#3F3F3F">初始化模型的参数</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> 3. Loop:&nbsp;<br/> - Implement forward propagation(</span><span style=";color:#3F3F3F">实现向前传播</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - Compute loss</span><span style=";color:#3F3F3F">（计算损失函数）</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F"><br/> - Implement backward propagation to get the gradients(</span><span style=";color:#3F3F3F">实现向后传播以获得梯度</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - Update parameters (gradient descent)(</span><span style=";color:#3F3F3F">更新参数，梯度下降</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">You often build helper functions to compute steps 1-3 and then merge them into one function we call&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">nn_model()</span></code><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">. Once you’ve built&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">nn_model()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">and learnt the right parameters, you can make predictions on new data.</span><span style=";color:#3F3F3F">（<em style="box-sizing: border-box"><span style="font-family:宋体">您经常构建帮助函数来计算步骤</span></em></span><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">1-3</span></em><em><span style="font-family:宋体;color:#3F3F3F">，然后将它们合并到一个函数中，我们称之为</span></em><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">nn_model</span></em></code><code><em><span style="font-size:15px;color:#3F3F3F">（）</span></em></code><em><span style="font-family:宋体;color:#3F3F3F">。一旦你建立了</span></em><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family: &#39;Source Code Pro&#39;;color:#3F3F3F">nn_model</span></em></code><code><em><span style="font-size:15px;color:#3F3F3F">（）</span></em></code><em><span style="font-family:宋体;color:#3F3F3F">并学习了正确的参数，你就可以预测新的数据。</span></em><span style=";color:#3F3F3F">）</span></p><h3 style="margin: 13px 0;background: white;box-sizing: border-box"><a style="box-sizing: border-box"></a><span style="font-size:27px;line-height:173%;font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">4.1 - Defining the neural network structure</span></h3><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Exercise</span></strong><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Define three variables:&nbsp;<br/> - n_x: the size of the input layer&nbsp; </span><span style=";color:#3F3F3F">输入层的节点数</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F"><br/> - n_h: the size of the hidden layer (set this to 4)&nbsp; </span><span style=";color:#3F3F3F">隐藏层的节点数</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F"><br/> - n_y: the size of the output layer&nbsp; </span><span style=";color:#3F3F3F">输出层的节点数</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Hint</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Use shapes of X and Y to find n_x and n_y. Also, hard code the hidden layer size to be 4.</span></p><p><span style="font-size:13px;font-family:&#39;Source Code Pro&#39;;color:#880000"></span></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;layer_sizes
&nbsp;
def&nbsp;layer_sizes(X,&nbsp;Y):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Arguments:
&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;--&nbsp;input&nbsp;dataset&nbsp;of&nbsp;shape&nbsp;(input&nbsp;size,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;--&nbsp;labels&nbsp;of&nbsp;shape&nbsp;(output&nbsp;size,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;n_x&nbsp;--&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;input&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;n_h&nbsp;--&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;hidden&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;n_y&nbsp;--&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;output&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;3&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;n_x&nbsp;=&nbsp;X.shape[0]&nbsp;#&nbsp;size&nbsp;of&nbsp;input&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;n_h&nbsp;=&nbsp;4
&nbsp;&nbsp;&nbsp;&nbsp;n_y&nbsp;=&nbsp;Y.shape[0]&nbsp;#&nbsp;size&nbsp;of&nbsp;output&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(n_x,&nbsp;n_h,&nbsp;n_y)</pre><p style="margin-top:0;margin-right:0;margin-bottom:27px;margin-left: 0;line-height:27px;background:white"><span style="font-size:13px;font-family:&#39;Source Code Pro&#39;;color:#333333"></span><br/></p><h3 style="margin-top:13px;margin-right:0;margin-bottom:13px;margin-left: 0;background:white"><span style="font-size:27px;line-height: 173%;font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">4.2 - Initialize the model’s parameters</span></h3><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Exercise</span></strong><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Implement the function&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">initialize_parameters()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">.</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Instructions</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">:&nbsp;<br/> - Make sure your parameters’ sizes are right. Refer to the neural network figure above if needed.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">确保你的参数的大小是正确的。如果需要，请参考上面的神经网络图。</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - You will initialize the weights matrices with random values. (</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">你将用随机值初始化权重矩阵。</span></em><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - Use:&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">np.random.randn(a,b) * 0.01</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">to randomly initialize a matrix of shape (a,b).&nbsp;<br/> - You will initialize the bias vectors as zeros. (</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">你将初始化偏置向量为零。</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - Use:&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">np.zeros((a,b))</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">to initialize a matrix of shape (a,b) with zeros.</span></p><pre class="brush:python;toolbar:false">def&nbsp;initialize_parameters(n_x,&nbsp;n_h,&nbsp;n_y):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Argument:
&nbsp;&nbsp;&nbsp;&nbsp;n_x&nbsp;--&nbsp;size&nbsp;of&nbsp;the&nbsp;input&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;n_h&nbsp;--&nbsp;size&nbsp;of&nbsp;the&nbsp;hidden&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;n_y&nbsp;--&nbsp;size&nbsp;of&nbsp;the&nbsp;output&nbsp;layer
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;params&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;parameters:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;--&nbsp;weight&nbsp;matrix&nbsp;of&nbsp;shape&nbsp;(n_h,&nbsp;n_x)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;--&nbsp;bias&nbsp;vector&nbsp;of&nbsp;shape&nbsp;(n_h,&nbsp;1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;--&nbsp;weight&nbsp;matrix&nbsp;of&nbsp;shape&nbsp;(n_y,&nbsp;n_h)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;--&nbsp;bias&nbsp;vector&nbsp;of&nbsp;shape&nbsp;(n_y,&nbsp;1)
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(2)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;we&nbsp;set&nbsp;up&nbsp;a&nbsp;seed&nbsp;so&nbsp;that&nbsp;your&nbsp;output&nbsp;matches&nbsp;ours&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#although&nbsp;the&nbsp;initialization&nbsp;is&nbsp;random.
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;=&nbsp;np.random.randn(n_h,&nbsp;n_x)
&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;=&nbsp;np.random.randn(n_y,&nbsp;n_h)
&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;np.zeros((n_h,&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;np.zeros((n_y,&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;(W1.shape&nbsp;==&nbsp;(n_h,&nbsp;n_x))
&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;(b1.shape&nbsp;==&nbsp;(n_h,&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;(W2.shape&nbsp;==&nbsp;(n_y,&nbsp;n_h))
&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;(b2.shape&nbsp;==&nbsp;(n_y,&nbsp;1))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;=&nbsp;{&quot;W1&quot;:&nbsp;W1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b1&quot;:&nbsp;b1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;W2&quot;:&nbsp;W2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b2&quot;:&nbsp;b2}
&nbsp;
return&nbsp;parameters</pre><p>&nbsp;</p><h3 style="margin-top:13px;margin-right:0;margin-bottom:13px;margin-left: 0;background:white"><span style="font-size:27px;line-height: 173%;font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">4.3 - The Loop</span></h3><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Question</span></strong><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Implement&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">forward_propagation()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">.</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Instructions</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">:&nbsp;<br/> - Look above at the mathematical representation of your classifier.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">请看上面的分类器的数学表示。</span></em><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - You can use the function&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">sigmoid()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">. It is built-in (imported) in the notebook.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">你可以使用函数</span></em><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">sigmoid()</span></em></code><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">.</span></em><em><span style="font-family:宋体;color:#3F3F3F">它是</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">notebook</span></em><em><span style="font-family:宋体;color:#3F3F3F">的内置函数</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - You can use the function&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">np.tanh()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">. It is part of the numpy library.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">你可以使用函数</span></em><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family: &#39;Source Code Pro&#39;;color:#3F3F3F">np.tanh()</span></em></code><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">.</span></em><em><span style="font-family:宋体;color:#3F3F3F">它是</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">notebook</span></em><em><span style="font-family:宋体;color:#3F3F3F">的内置函数</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - The steps you have to implement are:&nbsp;<br/> 1. Retrieve each parameter from the dictionary “parameters” (which is the output of&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">initialize_parameters()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">) by using&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">parameters[&quot;..&quot;]</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">使用</span></em><code style="box-sizing: border-box;background-color: rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">parameters [“..”]</span></em></code><em><span style="font-family:宋体;color:#3F3F3F">从字典</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">“parameters”</span></em><em><span style="font-family:宋体;color:#3F3F3F">（这是</span></em><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family: &#39;Source Code Pro&#39;;color:#3F3F3F">initialize_parameters</span></em></code><code><em><span style="font-size:15px;color:#3F3F3F">（）</span></em></code><em><span style="font-family:宋体;color:#3F3F3F">的输出）中检索每个参数。</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> 2. Implement Forward Propagation. Compute&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.59em 1005.56em 2.879em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.227em 1000.6em 4.169em -999.998em)"><span style="box-sizing: border-box">Z</span></span></span></span></span></span></span></em></span><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">1</span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></span></span></span></span><span style="box-sizing: border-box">,</span><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family: &#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(3.227em 1000.55em 4.169em -999.998em)"><span style="box-sizing: border-box">A</span></span></span></em></span><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">1</span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></span></span><span style="box-sizing: border-box">,</span><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family: &#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(3.227em 1000.6em 4.169em -999.998em)"><span style="box-sizing: border-box">Z</span></span></span></em></span><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">2</span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></span></span>&nbsp;<span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">and&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.441em 1001.49em 2.582em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.227em 1000.55em 4.169em -999.998em)"><span style="box-sizing: border-box">A</span></span></span></span></span></span></span></em></span><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">2</span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></span></span></span></span>&nbsp;<span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">(the vector of all your predictions on all the examples in the training set).(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">实现向前传播。计算</span><span style="box-sizing: border-box;outline: none"></span></em><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.491em 1006.25em 2.83em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.227em 1000.6em 4.169em -999.998em)"><span style="box-sizing: border-box">Z</span></span></span></span></span></span></span></em></span><em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span></span></span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">1</span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">，</span></span></span></span><em><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.227em 1000.55em 4.169em -999.998em)"><span style="box-sizing: border-box">A</span></span></span></span></em><em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span></span></span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">1</span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">，</span></span></span></span><em><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.227em 1000.6em 4.169em -999.998em)"><span style="box-sizing: border-box">Z</span></span></span></span></em><em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span></span></span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">2</span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></em><em>和<span style="box-sizing: border-box;outline: none"></span></em><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.441em 1001.49em 2.582em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.227em 1000.55em 4.169em -999.998em)"><span style="box-sizing: border-box">A</span></span></span></span></span></span></span></em></span><em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span></span></span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">2</span></em><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span></em><em>（训练中所有例子的所有预测的向量组）。</em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)&nbsp;<br/> - Values needed in the backpropagation are stored in “</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">cache</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">“. The&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">cache</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">will be given as an input to the backpropagation function.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">反向传播所需的值存储在</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">“</span></em><code style="box-sizing: border-box;background-color: rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">cache”</span></em></code><code><em><span style="font-size:15px;color:#3F3F3F">中。</span></em></code><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">cache`</span></em><em><span style="font-family:宋体;color:#3F3F3F">将作为反向传播函数的输入。</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)</span></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;forward_propagation
&nbsp;
def&nbsp;forward_propagation(X,&nbsp;parameters):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Argument:
&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;--&nbsp;input&nbsp;data&nbsp;of&nbsp;size&nbsp;(n_x,&nbsp;m)
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;parameters&nbsp;(output&nbsp;of&nbsp;initialization&nbsp;function)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;--&nbsp;The&nbsp;sigmoid&nbsp;output&nbsp;of&nbsp;the&nbsp;second&nbsp;activation
&nbsp;&nbsp;&nbsp;&nbsp;cache&nbsp;--&nbsp;a&nbsp;dictionary&nbsp;containing&nbsp;&quot;Z1&quot;,&nbsp;&quot;A1&quot;,&nbsp;&quot;Z2&quot;&nbsp;and&nbsp;&quot;A2&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Retrieve&nbsp;each&nbsp;parameter&nbsp;from&nbsp;the&nbsp;dictionary&nbsp;&quot;parameters&quot;
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;=&nbsp;parameters[&#39;W1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;=&nbsp;parameters[&#39;W2&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;parameters[&#39;b1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;parameters[&#39;b2&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Implement&nbsp;Forward&nbsp;Propagation&nbsp;to&nbsp;calculate&nbsp;A2&nbsp;(probabilities)
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;Z1&nbsp;=&nbsp;np.dot(W1,&nbsp;X)&nbsp;+&nbsp;b1
&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;=&nbsp;np.tanh(Z1)
&nbsp;&nbsp;&nbsp;&nbsp;Z2&nbsp;=&nbsp;np.dot(W2,&nbsp;A1)&nbsp;+&nbsp;b2
&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;=&nbsp;np.tanh(Z2)
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;assert(A2.shape&nbsp;==&nbsp;(1,&nbsp;X.shape[1]))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;cache&nbsp;=&nbsp;{&quot;Z1&quot;:&nbsp;Z1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;A1&quot;:&nbsp;A1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Z2&quot;:&nbsp;Z2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;A2&quot;:&nbsp;A2}
&nbsp;
return&nbsp;A2,&nbsp;cache</pre><p style="text-indent: 28px">&nbsp;</p><p style="margin-top:0;margin-right:0;margin-bottom:27px;margin-left: 0;line-height:27px;background:white"><strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Exercise</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Implement&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">compute_cost()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">to compute the value of the cost&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.788em 1000.5em 2.731em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">J</span></span></span></span></em></span></span></span>.</p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Instructions</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">:&nbsp;<br/> - There are many ways to implement the cross-entropy loss. To help you, we give you how we would have implemented&nbsp;<br/> </span><span style="box-sizing: border-box;display:inline-block"><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;clip:rect(1.044em 1007.49em 3.772em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">−</span><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.127em 1000.85em 4.417em -999.998em)"><span style="box-sizing: border-box;vertical-align:.002em">∑</span></span><em><span style="box-sizing: border-box;clip:rect(3.375em 1001.04em 4.268em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">i</span></span></span></span></em></span><span style="font-size: 14px">=</span><span style="font-size: 14px">0</span></span></span></span><em><span style="box-sizing: border-box;clip:rect(3.475em 1000.5em 4.169em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">m</span></span></span></span></em></span><span style="box-sizing: border-box;display:inline-block"></span></span><em><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.425em 1000.45em 4.368em -999.998em)"><span style="box-sizing: border-box">y</span></span></span></span></em></span><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">(</span></span><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">i</span></em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">)</span></span></span></span><span style="box-sizing: border-box">log</span><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box">(</span></span><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(3.425em 1000.5em 4.169em -999.998em)"><span style="box-sizing: border-box">a</span></span></span></em></span><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">[</span></span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">2</span><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">]</span><span style="box-sizing: border-box">(</span><em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">i</span></em><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">)</span></span></span><span style="box-sizing: border-box">)</span><span style="box-sizing: border-box;display:inline-block"></span>:</p><p style="line-height:27px;background:white"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F"></span></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;compute_cost
&nbsp;
def&nbsp;compute_cost(A2,&nbsp;Y,&nbsp;parameters):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Computes&nbsp;the&nbsp;cross-entropy&nbsp;cost&nbsp;given&nbsp;in&nbsp;equation&nbsp;(13)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Arguments:
&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;--&nbsp;The&nbsp;sigmoid&nbsp;output&nbsp;of&nbsp;the&nbsp;second&nbsp;activation,&nbsp;of&nbsp;shape&nbsp;(1,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;--&nbsp;&quot;true&quot;&nbsp;labels&nbsp;vector&nbsp;of&nbsp;shape&nbsp;(1,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;parameters&nbsp;W1,&nbsp;b1,&nbsp;W2&nbsp;and&nbsp;b2
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;cost&nbsp;--&nbsp;cross-entropy&nbsp;cost&nbsp;given&nbsp;equation&nbsp;(13)
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;=&nbsp;Y.shape[1]&nbsp;#&nbsp;number&nbsp;of&nbsp;example
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;cross-entropy&nbsp;cost
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;2&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;logprobs&nbsp;=&nbsp;np.multiply(np.log(A2),Y)
&nbsp;&nbsp;&nbsp;&nbsp;cost&nbsp;=&nbsp;-np.sum(logprobs&nbsp;+&nbsp;np.multiply(np.log(1&nbsp;-&nbsp;A2),1&nbsp;-&nbsp;Y))/m
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;cost&nbsp;=&nbsp;np.squeeze(cost)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;makes&nbsp;sure&nbsp;cost&nbsp;is&nbsp;the&nbsp;dimension&nbsp;we&nbsp;expect.&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;E.g.,&nbsp;turns&nbsp;[[17]]&nbsp;into&nbsp;17&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;assert(isinstance(cost,&nbsp;float))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cost</pre><p style="margin-top:0;margin-right:0;margin-bottom:27px;margin-left: 0;line-height:27px;background:white"><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F"></span><br/></p><p>梯度下降算法：</p><p><img src="/wp-content/uploads/image/20180201/1517492239122133.png" title="1517492239122133.png" alt="1517492239122133.png" width="991" height="500"/></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;backward_propagation
&nbsp;
def&nbsp;backward_propagation(parameters,&nbsp;cache,&nbsp;X,&nbsp;Y):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Implement&nbsp;the&nbsp;backward&nbsp;propagation&nbsp;using&nbsp;the&nbsp;instructions&nbsp;above.
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Arguments:
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;our&nbsp;parameters
&nbsp;&nbsp;&nbsp;&nbsp;cache&nbsp;--&nbsp;a&nbsp;dictionary&nbsp;containing&nbsp;&quot;Z1&quot;,&nbsp;&quot;A1&quot;,&nbsp;&quot;Z2&quot;&nbsp;and&nbsp;&quot;A2&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;--&nbsp;input&nbsp;data&nbsp;of&nbsp;shape&nbsp;(2,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;--&nbsp;&quot;true&quot;&nbsp;labels&nbsp;vector&nbsp;of&nbsp;shape&nbsp;(1,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;grads&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;gradients&nbsp;with&nbsp;respect&nbsp;to&nbsp;different&nbsp;parameters
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;=&nbsp;X.shape[1]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;First,&nbsp;retrieve&nbsp;W1&nbsp;and&nbsp;W2&nbsp;from&nbsp;the&nbsp;dictionary&nbsp;&quot;parameters&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;2&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;=&nbsp;parameters[&#39;W1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;=&nbsp;parameters[&#39;W2&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Retrieve&nbsp;also&nbsp;A1&nbsp;and&nbsp;A2&nbsp;from&nbsp;dictionary&nbsp;&quot;cache&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;2&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;=&nbsp;cache[&#39;A1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;=&nbsp;cache[&#39;A2&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Backward&nbsp;propagation:&nbsp;calculate&nbsp;dW1,&nbsp;db1,&nbsp;dW2,&nbsp;db2.
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;6&nbsp;lines&nbsp;of&nbsp;code,&nbsp;corresponding&nbsp;to&nbsp;6&nbsp;equations&nbsp;on&nbsp;slide&nbsp;above)
&nbsp;&nbsp;&nbsp;&nbsp;dZ2&nbsp;=&nbsp;A2-Y
&nbsp;&nbsp;&nbsp;&nbsp;dW2&nbsp;=&nbsp;(1.0/m)*np.dot(dZ2,A1.T)
&nbsp;&nbsp;&nbsp;&nbsp;db2&nbsp;=&nbsp;(1.0/m)*np.sum(dZ2,&nbsp;axis&nbsp;=&nbsp;1,&nbsp;keepdims=True)
&nbsp;&nbsp;&nbsp;&nbsp;dZ1&nbsp;=&nbsp;np.dot(W2.T,dZ2)*(1&nbsp;-&nbsp;np.power(A1,&nbsp;2))
&nbsp;&nbsp;&nbsp;&nbsp;dW1&nbsp;=&nbsp;np.dot(dZ1,&nbsp;X.T)/m
&nbsp;&nbsp;&nbsp;&nbsp;db1&nbsp;=&nbsp;np.sum(dZ1,axis=1,keepdims&nbsp;=&nbsp;True)/m
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;grads&nbsp;=&nbsp;{&quot;dW1&quot;:&nbsp;dW1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;db1&quot;:&nbsp;db1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;dW2&quot;:&nbsp;dW2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;db2&quot;:&nbsp;db2}
&nbsp;
return&nbsp;grads</pre><p>&nbsp;</p><p style="margin-top:0;margin-right:0;margin-bottom:27px;margin-left: 0;line-height:27px;background:white"><strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Question</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Implement the update rule. Use gradient descent. You have to use (dW1, db1, dW2, db2) in order to update (W1, b1, W2, b2).(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">实施更新规则。使用渐变下降。你必须使用（</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">dW1</span></em><em><span style="font-family:宋体;color:#3F3F3F">，</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">db1</span></em><em><span style="font-family:宋体;color:#3F3F3F">，</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">dW2</span></em><em><span style="font-family:宋体;color:#3F3F3F">，</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">db2</span></em><em><span style="font-family:宋体;color:#3F3F3F">）来更新（</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">W1</span></em><em><span style="font-family:宋体;color:#3F3F3F">，</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">b1</span></em><em><span style="font-family:宋体;color:#3F3F3F">，</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">W2</span></em><em><span style="font-family:宋体;color:#3F3F3F">，</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">b2</span></em><em><span style="font-family:宋体;color:#3F3F3F">）。</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">General gradient descent rule</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">:&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.54em 1004.96em 3.127em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">θ</span></span></span></span></em></span><span style="box-sizing: border-box">=</span><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">θ</span></em><span style="box-sizing: border-box">−</span></span><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">α</span></em><span style="box-sizing: border-box;display:inline-block"><span style="font-size:14px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(3.375em 1000.7em 4.169em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">∂</span><em><span style="box-sizing: border-box">J</span></em></span></span></span></span><span style="box-sizing: border-box;clip:rect(3.375em 1000.7em 4.169em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">∂</span><em><span style="box-sizing: border-box">θ</span></em></span></span></span>&nbsp;<span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">where&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.987em 1000.55em 2.731em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">α</span></span></span></span></em></span></span></span>&nbsp;<span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">is the learning rate and&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.739em 1000.5em 2.731em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box">θ</span></span></span></span></em></span></span></span>&nbsp;<span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">represents a parameter.</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Illustration</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">: The gradient descent algorithm with a good learning rate (converging) and a bad learning rate (diverging). Images courtesy of Adam Harley.(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">具有良好学习速率（收敛）和不良学习速率（发散）的梯度下降算法。</span></em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)</span></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;update_parameters
&nbsp;
def&nbsp;update_parameters(parameters,&nbsp;grads,&nbsp;learning_rate&nbsp;=&nbsp;1.2):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Updates&nbsp;parameters&nbsp;using&nbsp;the&nbsp;gradient&nbsp;descent&nbsp;update&nbsp;rule&nbsp;given&nbsp;above
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Arguments:
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;parameters
&nbsp;&nbsp;&nbsp;&nbsp;grads&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;gradients
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;updated&nbsp;parameters
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Retrieve&nbsp;each&nbsp;parameter&nbsp;from&nbsp;the&nbsp;dictionary&nbsp;&quot;parameters&quot;
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;=&nbsp;parameters[&quot;W1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;parameters[&quot;b1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;=&nbsp;parameters[&quot;W2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;parameters[&quot;b2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Retrieve&nbsp;each&nbsp;gradient&nbsp;from&nbsp;the&nbsp;dictionary&nbsp;&quot;grads&quot;
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;dW1&nbsp;=&nbsp;grads[&quot;dW1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;db1&nbsp;=&nbsp;grads[&quot;db1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;dW2&nbsp;=&nbsp;grads[&quot;dW2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;db2&nbsp;=&nbsp;grads[&quot;db2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Update&nbsp;rule&nbsp;for&nbsp;each&nbsp;parameter
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;=&nbsp;W1&nbsp;-&nbsp;learning_rate*dW1
&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;b1&nbsp;-&nbsp;learning_rate*db1
&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;=&nbsp;W2&nbsp;-&nbsp;learning_rate*dW2
&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;b2&nbsp;-&nbsp;learning_rate*db2
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;=&nbsp;{&quot;W1&quot;:&nbsp;W1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b1&quot;:&nbsp;b1,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;W2&quot;:&nbsp;W2,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b2&quot;:&nbsp;b2}
&nbsp;
return&nbsp;parameters</pre><p>&nbsp;</p><h3 style="margin-top:13px;margin-right:0;margin-bottom:13px;margin-left: 0;background:white"><span style="font-size:27px;line-height: 173%;font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">4.4 - Integrate parts 4.1, 4.2 and 4.3 in nn_model()</span></h3><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Question</span></strong><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Build your neural network model in&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">nn_model()</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">.</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Instructions</span></strong><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">: The neural network model has to use the previous functions in the right order.</span></p><p><span style="font-size:13px;font-family:&#39;Source Code Pro&#39;;color:#880000"></span></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;nn_model
&nbsp;
def&nbsp;nn_model(X,&nbsp;Y,&nbsp;n_h,&nbsp;num_iterations&nbsp;=&nbsp;10000,&nbsp;print_cost=False):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Arguments:
&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;--&nbsp;dataset&nbsp;of&nbsp;shape&nbsp;(2,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;--&nbsp;labels&nbsp;of&nbsp;shape&nbsp;(1,&nbsp;number&nbsp;of&nbsp;examples)
&nbsp;&nbsp;&nbsp;&nbsp;n_h&nbsp;--&nbsp;size&nbsp;of&nbsp;the&nbsp;hidden&nbsp;layer
&nbsp;&nbsp;&nbsp;&nbsp;num_iterations&nbsp;--&nbsp;Number&nbsp;of&nbsp;iterations&nbsp;in&nbsp;gradient&nbsp;descent&nbsp;loop
&nbsp;&nbsp;&nbsp;&nbsp;print_cost&nbsp;--&nbsp;if&nbsp;True,&nbsp;print&nbsp;the&nbsp;cost&nbsp;every&nbsp;1000&nbsp;iterations
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns:
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;parameters&nbsp;learnt&nbsp;by&nbsp;the&nbsp;model.&nbsp;They&nbsp;can&nbsp;then&nbsp;be&nbsp;used&nbsp;to&nbsp;predict.
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;np.random.seed(3)
&nbsp;&nbsp;&nbsp;&nbsp;n_x&nbsp;=&nbsp;layer_sizes(X,&nbsp;Y)[0]
&nbsp;&nbsp;&nbsp;&nbsp;n_y&nbsp;=&nbsp;layer_sizes(X,&nbsp;Y)[2]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Initialize&nbsp;parameters,&nbsp;then&nbsp;retrieve&nbsp;W1,&nbsp;b1,&nbsp;W2,&nbsp;b2.&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#Inputs:&nbsp;&quot;n_x,&nbsp;n_h,&nbsp;n_y&quot;.&nbsp;Outputs&nbsp;=&nbsp;&quot;W1,&nbsp;b1,&nbsp;W2,&nbsp;b2,&nbsp;parameters&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;5&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;=&nbsp;initialize_parameters(n_x,&nbsp;n_h,&nbsp;n_y)
&nbsp;&nbsp;&nbsp;&nbsp;W1&nbsp;=&nbsp;parameters[&#39;W1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;b1&nbsp;=&nbsp;parameters[&#39;b1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;W2&nbsp;=&nbsp;parameters[&#39;W2&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;b2&nbsp;=&nbsp;parameters[&#39;b2&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Loop&nbsp;(gradient&nbsp;descent)
&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;pdb
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;num_iterations):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;4&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Forward&nbsp;propagation.&nbsp;Inputs:&nbsp;&quot;X,&nbsp;parameters&quot;.&nbsp;Outputs:&nbsp;&quot;A2,&nbsp;cache&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A2,&nbsp;cache&nbsp;=&nbsp;forward_propagation(X,&nbsp;parameters)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Cost&nbsp;function.&nbsp;Inputs:&nbsp;&quot;A2,&nbsp;Y,&nbsp;parameters&quot;.&nbsp;Outputs:&nbsp;&quot;cost&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cost&nbsp;=&nbsp;compute_cost(A2,&nbsp;Y,&nbsp;parameters)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Backpropagation.&nbsp;Inputs:&nbsp;&quot;parameters,&nbsp;cache,&nbsp;X,&nbsp;Y&quot;.&nbsp;Outputs:&nbsp;&quot;grads&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grads&nbsp;=&nbsp;backward_propagation(parameters,&nbsp;cache,&nbsp;X,&nbsp;Y)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Gradient&nbsp;descent&nbsp;parameter&nbsp;update.&nbsp;Inputs:&nbsp;&quot;parameters,&nbsp;grads&quot;.&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Outputs:&nbsp;&quot;parameters&quot;.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;=&nbsp;update_parameters(parameters,&nbsp;grads)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Print&nbsp;the&nbsp;cost&nbsp;every&nbsp;1000&nbsp;iterations
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;print_cost&nbsp;and&nbsp;i&nbsp;%&nbsp;1000&nbsp;==&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&quot;Cost&nbsp;after&nbsp;iteration&nbsp;%i:&nbsp;%f&quot;&nbsp;%(i,&nbsp;cost))
&nbsp;
return&nbsp;parameters</pre><p style="text-indent: 26px"><span style="font-size:13px;font-family:&#39;Source Code Pro&#39;;color:#333333"></span><br/></p><p style="text-indent: 26px"><span style="font-size:13px;font-family:&#39;Source Code Pro&#39;;color:#333333">&nbsp;</span></p><h3 style="margin-top:13px;margin-right:0;margin-bottom:13px;margin-left: 0;background:white"><span style="font-size:27px;line-height: 173%;font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F;font-weight:normal">4.5 Predictions</span></h3><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Question</span></strong><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">: Use your model to predict by building predict().&nbsp;Use forward propagation to predict results.</span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><strong style="box-sizing: border-box"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">Reminder</span></strong><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">: predictions =&nbsp;</span><span style="box-sizing: border-box;outline: none"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;display:inline-block"><em><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(1.937em 1029.62em 3.425em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.425em 1000.45em 4.368em -999.998em)"><span style="box-sizing: border-box">y</span></span></span></span></span></span></span></em></span><em><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">p</span><span style="box-sizing: border-box">r</span><span style="box-sizing: border-box">e</span><span style="box-sizing: border-box">d</span><span style="box-sizing: border-box">i</span><span style="box-sizing: border-box">c</span><span style="box-sizing: border-box">t</span><span style="box-sizing: border-box">i</span><span style="box-sizing: border-box">o</span><span style="box-sizing: border-box">n</span></span></span></span></em></span><span style="box-sizing: border-box;display:inline-block"></span></span><span style="box-sizing: border-box">=</span><span style="box-sizing: border-box"><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box">?</span></span></span><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box">{activation &gt; 0.5}</span></span><span style="font-size: 20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F">=</span><span style="box-sizing: border-box;vertical-align:-.196em"><span style="font-size:20px;font-family:&#39;STIXSizeOneSym&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box">{</span></span></span><span style="box-sizing: border-box"><span style="box-sizing: border-box;display:inline-block"><span style="font-size:20px;font-family:&#39;STIXGeneral&#39;,serif;color:#3F3F3F"><span style="box-sizing: border-box;clip:rect(3.227em 1000.4em 4.219em -999.998em)"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.177em 1000.4em 4.169em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">1</span></span></span></span></span></span><span style="box-sizing: border-box;clip:rect(3.227em 1008.19em 4.219em -999.998em)"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.177em 1008.19em 4.169em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">if</span><span style="box-sizing: border-box">&nbsp;</span></span><em><span style="font-size: 20px">a</span><span style="box-sizing: border-box">c</span><span style="box-sizing: border-box">t</span><span style="box-sizing: border-box">i</span><span style="box-sizing: border-box">v</span><span style="box-sizing: border-box">a</span><span style="box-sizing: border-box">t</span><span style="box-sizing: border-box">i</span><span style="box-sizing: border-box">o</span><span style="box-sizing: border-box">n</span></em><span style="font-size: 20px">&gt;</span><span style="font-size: 20px">0.5</span><span style="font-size: 20px">&nbsp;</span><span style="font-size: 20px">0</span></span></span></span></span><span style="box-sizing: border-box;clip:rect(3.227em 1003.87em 4.219em -999.998em)"><span style="box-sizing: border-box;display:inline-block"><span style="box-sizing: border-box;clip:rect(3.177em 1003.87em 4.169em -999.998em)"><span style="box-sizing: border-box"><span style="box-sizing: border-box"><span style="box-sizing: border-box">otherwise</span></span></span></span></span></span></span></span></span></p><p style="margin: 0 0 27px;line-height: 27px;background: white;box-sizing: border-box;word-wrap: break-word"><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">As an example, if you would like to set the entries of a matrix X to 0 and 1 based on a threshold you would do:&nbsp;</span><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">X_new = (X &gt; threshold)</span></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">&nbsp;</span><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">(</span><em style="box-sizing: border-box"><span style="font-family:宋体;color:#3F3F3F">例如，如果你想根据一个阈值将矩阵</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">X</span></em><em><span style="font-family:宋体;color:#3F3F3F">的条目设置为</span></em><em><span style="font-family: &#39;microsoft yahei&#39;,serif;color:#3F3F3F">0</span></em><em><span style="font-family:宋体;color:#3F3F3F">和</span></em><em><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">1</span></em><em><span style="font-family:宋体;color:#3F3F3F">，你可以这样做：</span></em><code style="box-sizing: border-box;background-color:rgba(128, 128, 128, 0.0745098);border-radius: 0px"><em><span style="font-size:15px;font-family:&#39;Source Code Pro&#39;;color:#3F3F3F">X_new = (X &gt; threshold)</span></em></code><span style="font-family:&#39;microsoft yahei&#39;,serif;color:#3F3F3F">)</span></p><pre class="brush:python;toolbar:false">#&nbsp;GRADED&nbsp;FUNCTION:&nbsp;predict
&nbsp;
def&nbsp;predict(parameters,&nbsp;X):
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;the&nbsp;learned&nbsp;parameters,&nbsp;predicts&nbsp;a&nbsp;class&nbsp;for&nbsp;each&nbsp;example&nbsp;in&nbsp;X
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Arguments:
&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;--&nbsp;python&nbsp;dictionary&nbsp;containing&nbsp;your&nbsp;parameters&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;--&nbsp;input&nbsp;data&nbsp;of&nbsp;size&nbsp;(n_x,&nbsp;m)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;predictions&nbsp;--&nbsp;vector&nbsp;of&nbsp;predictions&nbsp;of&nbsp;our&nbsp;model&nbsp;(red:&nbsp;0&nbsp;/&nbsp;blue:&nbsp;1)
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Computes&nbsp;probabilities&nbsp;using&nbsp;forward&nbsp;propagation,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#and&nbsp;classifies&nbsp;to&nbsp;0/1&nbsp;using&nbsp;0.5&nbsp;as&nbsp;the&nbsp;threshold.
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;START&nbsp;CODE&nbsp;HERE&nbsp;###&nbsp;(≈&nbsp;2&nbsp;lines&nbsp;of&nbsp;code)
&nbsp;&nbsp;&nbsp;&nbsp;A2,&nbsp;cache&nbsp;=&nbsp;forward_propagation(X,&nbsp;parameters)
&nbsp;&nbsp;&nbsp;&nbsp;predictions&nbsp;=&nbsp;np.array([0&nbsp;if&nbsp;i&nbsp;&lt;=&nbsp;0.5&nbsp;else&nbsp;1&nbsp;for&nbsp;i&nbsp;in&nbsp;np.squeeze(A2)])
&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;END&nbsp;CODE&nbsp;HERE&nbsp;###
&nbsp;
return&nbsp;predictions
parameters,&nbsp;X_assess&nbsp;=&nbsp;predict_test_case()
&nbsp;
predictions&nbsp;=&nbsp;predict(parameters,&nbsp;X_assess)
print(&quot;predictions&nbsp;mean&nbsp;=&nbsp;&quot;&nbsp;+&nbsp;str(np.mean(predictions)))
#&nbsp;Build&nbsp;a&nbsp;model&nbsp;with&nbsp;a&nbsp;n_h-dimensional&nbsp;hidden&nbsp;layer
parameters&nbsp;=&nbsp;nn_model(X,&nbsp;Y,&nbsp;n_h&nbsp;=&nbsp;4,&nbsp;num_iterations&nbsp;=&nbsp;10000,&nbsp;print_cost=True)
&nbsp;
#&nbsp;Plot&nbsp;the&nbsp;decision&nbsp;boundary
plot_decision_boundary(lambda&nbsp;x:&nbsp;predict(parameters,&nbsp;x.T),&nbsp;X,&nbsp;np.squeeze(Y))
plt.title(&quot;Decision&nbsp;Boundary&nbsp;for&nbsp;hidden&nbsp;layer&nbsp;size&nbsp;&quot;&nbsp;+&nbsp;str(4))
#&nbsp;Print&nbsp;accuracy
predictions&nbsp;=&nbsp;predict(parameters,&nbsp;X)
print&nbsp;(&#39;Accuracy:&nbsp;%d&#39;&nbsp;%&nbsp;float((np.dot(Y,predictions.T)&nbsp;+&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.dot(1-Y,1-predictions.T))/float(Y.size)*100)&nbsp;+&nbsp;&#39;%&#39;)</pre><p>The image is</p><p style="text-align: center;"><img src="/wp-content/uploads/image/20180201/1517492418836497.png" title="1517492418836497.png" alt="3.png"/></p><p>Accuracy: 88%</p><p><br/></p>